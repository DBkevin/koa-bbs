## 用户相关
### 用户信息
#### 功能说明
接下来我们将制作用户的个人中心页面，作为用户的个人信息展示页。在此页面中，我们可以看到该用户发过的帖子，发表的评论等。
#### 设置路由
* 显示用户信息  `get users/{user}` 
* 显示编辑用户信息  `get users/{user}/edit` 
* 处理edit页面提交的的更改 `post /users/{user} `


|HTTP请求| URI | 方法 | 作用 |
| :---   | :--- | :----| :------- |
| GET  | /users/{user} |users.js->show| 显示用户个人信息|
| GET  | /users/{user}/edit | users.js->edit | 显示编辑个人资料页面|
| POST | /users/{user} | users.js->update | 处理edit 页面提交的更改
在`router/index.js`中吧以上三个路由全部添加上去:
```js
    router.get('/users/:user', require('./users').show);
    router.get('/users/:user/edit', require('./users').edit);
    router.post('/users/:user', require("./users").update);	
```
在`router`文件夹下面，新建一个文件`users.js`。用来保存所有跟`users`有关的路由，当作控制器使用。接下来我们增加 `show` 方法来处理个人页面的展示：

```js
const db = require('../core/db');
module.exports = {
    async show(ctx, next) {
        let { user } = ctx.params;
        let queryUserSQL = `select * from users where id=${user}`;
        let queryUser = await db(queryUserSQL);
        if (queryUser) {
          await  ctx.render("layouts/index", {
                title: queryUser[0].name + '的个人中心',
                pagename: '../users/show',
                routerName: 'show',
            });
        } else {
            ctx.body = "用户不存在！";
        }
    }
}
```
借来下，在`views/users`下新建一个`show.ejs`：
```html
<div class="row">
  <div class="col-lg-3 col-md-3 hidden-sm hidden-xs user-info">
    <div class="card ">
      <img class="card-img-top" src="/images/user.png" alt=" <%= user.name %>">
      <div class="card-body">
            <h5><strong>个人简介</strong></h5>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. </p>
            <hr>
            <h5><strong>注册于</strong></h5>
            <p>January 01 1901</p>
      </div>
    </div>
  </div>
  <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
    <div class="card ">
      <div class="card-body">
          <h1 class="mb-0" style="font-size:22px;"> <%= user.name %> <small><%=user.email %></small></h1>
      </div>
    </div>
    <hr>

    <%# 用户发布的内容  %>
    <div class="card ">
      <div class="card-body">
        暂无数据 ~_~
      </div>
    </div>

  </div>
</div>
```
启动应用，打开`http://localhost:3000/users/1` 就能看到个人信息了。如图1：

如上图所示，头像、个人简介和注册时间还都是假数据，接下来我们将逐步添加这些功能。

